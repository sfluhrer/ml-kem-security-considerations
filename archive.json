{
  "magic": "E!vIA5L86J2I",
  "timestamp": "2025-03-13T00:55:14.769347+00:00",
  "repo": "sfluhrer/ml-kem-security-considerations",
  "labels": [
    {
      "name": "bug",
      "description": "Something isn't working",
      "color": "d73a4a"
    },
    {
      "name": "documentation",
      "description": "Improvements or additions to documentation",
      "color": "0075ca"
    },
    {
      "name": "duplicate",
      "description": "This issue or pull request already exists",
      "color": "cfd3d7"
    },
    {
      "name": "enhancement",
      "description": "New feature or request",
      "color": "a2eeef"
    },
    {
      "name": "good first issue",
      "description": "Good for newcomers",
      "color": "7057ff"
    },
    {
      "name": "help wanted",
      "description": "Extra attention is needed",
      "color": "008672"
    },
    {
      "name": "invalid",
      "description": "This doesn't seem right",
      "color": "e4e669"
    },
    {
      "name": "question",
      "description": "Further information is requested",
      "color": "d876e3"
    },
    {
      "name": "wontfix",
      "description": "This will not be worked on",
      "color": "ffffff"
    }
  ],
  "issues": [
    {
      "number": 3,
      "id": "I_kwDOM54HI86Y-q7W",
      "title": "Include discussion of using ML-KEM in ways other than an ephemeral Key Exchange",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/issues/3",
      "state": "OPEN",
      "author": "sfluhrer",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "While using ML-KEM as a DH replacement in (say) TLS or IKE is one important use case, it's not the only one.  We should also discuss how ML-KEM might be used as a component within IES, and as authentication, and possibly other use cases.",
      "createdAt": "2024-10-04T14:48:33Z",
      "updatedAt": "2024-11-15T20:40:17Z",
      "closedAt": null,
      "comments": [
        {
          "author": "QuynhDangNIST",
          "authorAssociation": "COLLABORATOR",
          "body": "Sounds good! ",
          "createdAt": "2024-10-05T11:15:54Z",
          "updatedAt": "2024-10-05T11:15:54Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "I've been thinking this over, and the goal of this draft should be to explain how to use already defined crypto (ML-KEM, specifically), and not to invent it.  It is straightforward to define an IES-ML-KEM (by simply replacing DH with ML-KEM), is that too big of an innovation?  How about using ML-KEM for authentication; should we endorse the protocol proposed in draft-celi-wiggers-tls-authkem?",
          "createdAt": "2024-10-07T01:50:52Z",
          "updatedAt": "2024-10-07T01:50:52Z"
        },
        {
          "author": "QuynhDangNIST",
          "authorAssociation": "COLLABORATOR",
          "body": "I don't think IETF has an official spec for IES. If that is true, it is more like we'd need to write a spec for that.  With a ML-KEM certificate, the certificate owner may not need signatures for its identity authentication.  For example, one can add an optional ML-KEM certificate in \"Key Exch\" in Figure 1, TLS 1.3, then the client never needs \"Certificate\" and \"CertificateVerify\", so the server never needs to ask for \"CertificateRequest\".  That is due to the MAC confirmation at the end of the handshake.   \r\n\r\nTo improve efficiency, the client just sends a hash of its certificate if the server saves the certificate for later connections.  If one uses PQ sig to sign the certificate, the certificate is big.  And most connections, the key exchanges do not have \"Certificate\" and \"CertificateVerify\" messages.  If one uses an ECC sig at this moment, then the size cost is basically the ML-KEM public key. \r\n\r\nOne can also do ephemeral key exchanges by sending a fresh public ML-KEM key a long with the certificate and this fresh public key will be used for the next connection. In the next connection, the certificate does not need to to be sent again, just send a new fresh public ML-KEM key for the future connection and the hash of the public key to be used for this current exchange.  But this method requires extensions and the server to save the future ML-KEM public key.  \r\n\r\nBut that way has PQ security for both (KEM and authentication) without needing PQ signatures to be exchanged for every connection because the authentication is from the security of ML-KEM and the MAC.  ",
          "createdAt": "2024-10-07T11:13:35Z",
          "updatedAt": "2024-10-07T11:13:35Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "The IETF does have HPKE, which gives a way to do public key encryption - I added that.  As for authentication, there are so many possibilities that I do not see how we could provide real guidance there",
          "createdAt": "2024-11-15T20:40:16Z",
          "updatedAt": "2024-11-15T20:40:16Z"
        }
      ]
    },
    {
      "number": 11,
      "id": "I_kwDOM54HI86eurkk",
      "title": "Turn the reference to draft-connolly-cfrg-hpke-mlkem into a citation",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/issues/11",
      "state": "CLOSED",
      "author": "sfluhrer",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "I'm not how to cite an internet draft - someone help me here",
      "createdAt": "2024-11-15T20:28:44Z",
      "updatedAt": "2025-01-30T02:07:06Z",
      "closedAt": "2025-01-30T02:07:06Z",
      "comments": []
    },
    {
      "number": 13,
      "id": "I_kwDOM54HI86fdcI1",
      "title": "Comments fom Thom Wiggers",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/issues/13",
      "state": "OPEN",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "https://mailarchive.ietf.org/arch/msg/cfrg/s8awRO4tkRbHItJzinIw9OjiJfY/\r\n\r\n did have the following two nits:\r\n\r\n- This document concerns security considerations on how ML-KEM should be integrated into protocols; not security considerations for implementing ML-KEM (which I think are indeed better covered by a draft that documents the algorithm itself).   Perhaps the title can be slightly changed to reflect this, though? Adding \u201cUsage of\u201d or \u201cApplications\u201d in some way might be sufficient, and could help make finding this draft easier.\r\n\r\n- Another small nit is the discussion on decapsulation failures:\r\n\r\n > [..] For all three parameter sets, the probability is so low that most likely an actual decapsulation failure will never be seen for any ML-KEM exchange anywhere (not only for your protocol, but over all protocols that uses ML-KEM).\r\n\r\nI suggest writing \u201chonest decapsulation failure\u201d or \u201crandomly occurring decapsulation failure\u201d to further emphasise this is separate from the malicious case.\r\n\r\nBoth of these are pretty pedantic, however, so if you disagree then no hard feelings :-) ",
      "createdAt": "2024-11-20T10:09:59Z",
      "updatedAt": "2024-11-22T13:49:56Z",
      "closedAt": null,
      "comments": [
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "I'm wondering if you had a concrete suggestion for a title.  \"Usage of ML-KEM in security protocols\", maybe?\r\n\r\n(I've already integrated your comment about decapsulation failure...",
          "createdAt": "2024-11-22T13:49:55Z",
          "updatedAt": "2024-11-22T13:49:55Z"
        }
      ]
    },
    {
      "number": 17,
      "id": "I_kwDOM54HI86kbfjX",
      "title": "Should mention that ML-KEM is variable time",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/issues/17",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "Should mention that ML-KEM is variable time. This is likely something readers would like to know. The variable time in ML-KEM does not affect Confidentiality but it can affect Availability.",
      "createdAt": "2024-12-25T09:30:23Z",
      "updatedAt": "2024-12-26T07:26:39Z",
      "closedAt": "2024-12-26T07:26:39Z",
      "comments": [
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "The only variable time part of ML-KEM I\u2019m aware of is the SampleNTT subcomponent (actually, it could be made constant time by oversampling, but let\u2019s talk about the straight-forward approach).\r\n\r\nHowever, the time delta will be tiny; I haven\u2019t run the numbers, but given that you do that sampling a large number of times, the total time taken should be close to a normal distribution, with a fairly small variance.  I don\u2019t personally know if that\u2019s worth mentioning.  Thoughts?\r\n",
          "createdAt": "2024-12-25T14:25:32Z",
          "updatedAt": "2024-12-25T14:25:32Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Yes, I think I confused ML-KEM with ML-DSA very the delta is large. I agree that the total varience is probably low and therefore not worth mentioning",
          "createdAt": "2024-12-26T07:26:39Z",
          "updatedAt": "2024-12-26T07:26:39Z"
        }
      ]
    }
  ],
  "pulls": [
    {
      "number": 1,
      "id": "PR_kwDOM54HI859iDwh",
      "title": "Update draft-sfluhrer-cfrg-ml-kem-security-considerations.md",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/1",
      "state": "MERGED",
      "author": "QuynhDangNIST",
      "authorAssociation": "COLLABORATOR",
      "assignees": [
        "sfluhrer"
      ],
      "labels": [],
      "body": "First quick pass to add new and proposed text changes to Scott's draft.\r\n\r\n",
      "createdAt": "2024-10-03T17:38:40Z",
      "updatedAt": "2024-10-04T18:09:21Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "5b7778eb6a0dc9e97b09ce72474def328d490766",
      "headRepository": "QuynhDangNIST/ml-kem-security-considerations",
      "headRefName": "patch-1",
      "headRefOid": "f4cd5411fb4ed56b856afc16c4f55b63b151e263",
      "closedAt": "2024-10-04T18:09:21Z",
      "mergedAt": "2024-10-04T18:09:21Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "072d7b8284788bd64ef36e88bd83e0b005cdb01a"
      },
      "comments": [
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "Looks mostly good.  I have a few tweaks - I'll merge and then do the few fixups needed",
          "createdAt": "2024-10-03T17:52:40Z",
          "updatedAt": "2024-10-03T17:52:40Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "Updates from Quynh",
          "createdAt": "2024-10-03T17:55:54Z",
          "updatedAt": "2024-10-03T17:55:54Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86L2qdd",
          "commit": {
            "abbreviatedOid": "de140de"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "COMMENTED",
          "body": "Looks mostly good. I have a few tweaks - I'll try to merge and then do the few fixups needed",
          "createdAt": "2024-10-03T18:03:49Z",
          "updatedAt": "2024-10-03T18:03:49Z",
          "comments": []
        },
        {
          "id": "PRR_kwDOM54HI86L9sbl",
          "commit": {
            "abbreviatedOid": "a17fb50"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2024-10-04T14:21:38Z",
          "updatedAt": "2024-10-04T14:21:38Z",
          "comments": []
        }
      ]
    },
    {
      "number": 2,
      "id": "PR_kwDOM54HI859nqlr",
      "title": "Try to fix build errors",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/2",
      "state": "CLOSED",
      "author": "sfluhrer",
      "authorAssociation": "OWNER",
      "assignees": [
        "sfluhrer"
      ],
      "labels": [],
      "body": "",
      "createdAt": "2024-10-04T13:04:00Z",
      "updatedAt": "2024-11-22T13:47:55Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "c061b81cb548155ab8a925fe5a85fbd5ce351168",
      "headRepository": "sfluhrer/ml-kem-security-considerations",
      "headRefName": "sfluhrer-build-fix",
      "headRefOid": "ea822556f4f1c80c1c3d24cf4d7ded05c61251ce",
      "closedAt": "2024-11-22T13:47:55Z",
      "mergedAt": null,
      "mergedBy": null,
      "mergeCommit": null,
      "comments": [],
      "reviews": []
    },
    {
      "number": 4,
      "id": "PR_kwDOM54HI859o4t3",
      "title": "Proposed wording for high-entrropy inputs, gender neutrality",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/4",
      "state": "MERGED",
      "author": "soatok",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "Wording:\r\n\r\nHigh-quality entropy source is a first swing at an improvement.\r\n\r\nWe could lean into the NIST DRBG definitions if we wanted precise terminology, but I feel there's often a contention between precision and clarity, and security consideration documents scream \"focus on clarity\" to me.  I'm open to dissenting opinions here, of course.\r\n\r\nPronouns:\r\n\r\nThe adversary is not a specific actor and thus neutral pronouns (they'them) are more suitable. If a specific actor was in mind (e.g., Mallory), rather than just a vague \"adversary\", then this would be an incorrect change.",
      "createdAt": "2024-10-04T15:56:51Z",
      "updatedAt": "2024-10-04T19:20:43Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "afc77ef49f1deb83fe6f501b44ba73cc5d5d53a7",
      "headRepository": "soatok/ml-kem-security-considerations",
      "headRefName": "patch-1",
      "headRefOid": "137e8b52076468598a7c26a6027c57ca41cdbff6",
      "closedAt": "2024-10-04T17:11:35Z",
      "mergedAt": "2024-10-04T17:11:35Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "5b7778eb6a0dc9e97b09ce72474def328d490766"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86L--ND",
          "commit": {
            "abbreviatedOid": "137e8b5"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "Now, the sentence you added is actually redundant with the previous sentence.  However, I have no issue with leaving it in there",
          "createdAt": "2024-10-04T16:57:10Z",
          "updatedAt": "2024-10-04T16:57:10Z",
          "comments": []
        }
      ]
    },
    {
      "number": 5,
      "id": "PR_kwDOM54HI859rGjN",
      "title": "Update draft-sfluhrer-cfrg-ml-kem-security-considerations.md",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/5",
      "state": "MERGED",
      "author": "quynh97",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "The sentence is not needed and it does not have a clear meaning with \"random\".  The strength of K, the shared secret key, is the strength of the random m.  The strength of the decryption key given the encryption key is the  difficulty of the LWE problem.",
      "createdAt": "2024-10-04T22:33:26Z",
      "updatedAt": "2024-10-05T11:02:33Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "4e0bff8d1ee2294f0da78a471ffec0ba1aa00457",
      "headRepository": "quynh97/ml-kem-security-considerations",
      "headRefName": "patch-1",
      "headRefOid": "513d14c16bfc7739d3467b9937d42bbc9f0dd142",
      "closedAt": "2024-10-05T11:02:32Z",
      "mergedAt": "2024-10-05T11:02:32Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "a9f52be20e7ed24fe14a1974c5152cbaf27c7b0f"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86MCv64",
          "commit": {
            "abbreviatedOid": "513d14c"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2024-10-05T11:02:17Z",
          "updatedAt": "2024-10-05T11:02:17Z",
          "comments": []
        }
      ]
    },
    {
      "number": 6,
      "id": "PR_kwDOM54HI859zygU",
      "title": "Update draft-sfluhrer-cfrg-ml-kem-security-considerations.md",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/6",
      "state": "MERGED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "I looked through the document (as it looked yesterday) and made suggested changes. I made a spell check and made several changes to the markdown. I added a new Table showing performance, added references, and added more information on when ML-KEM is a drop-in replacement and when it is not.",
      "createdAt": "2024-10-07T12:23:48Z",
      "updatedAt": "2024-10-07T12:50:27Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "0dcd3b46153b4527fc1b6492cabf07d0b668d1bf",
      "headRepository": "emanjon/ml-kem-security-considerations",
      "headRefName": "patch-1",
      "headRefOid": "03f3e71e381e6fa1f1fa71a50040c4cb54269dc8",
      "closedAt": "2024-10-07T12:38:21Z",
      "mergedAt": "2024-10-07T12:38:21Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "55e4580ae440ab7709acf3634b5e947695d96003"
      },
      "comments": [
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "Thanks John",
          "createdAt": "2024-10-07T12:38:39Z",
          "updatedAt": "2024-10-07T12:38:39Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "> Do you want to be added to the authors list?\r\n\r\nYes please. But by approving the pull request I should already have been added. Thanks again for driving this.",
          "createdAt": "2024-10-07T12:50:25Z",
          "updatedAt": "2024-10-07T12:50:25Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86MLe7P",
          "commit": {
            "abbreviatedOid": "234fc65"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "Do you want to be added to the authors list?",
          "createdAt": "2024-10-07T12:34:34Z",
          "updatedAt": "2024-10-07T12:34:34Z",
          "comments": []
        }
      ]
    },
    {
      "number": 7,
      "id": "PR_kwDOM54HI85932Iz",
      "title": "Update draft-sfluhrer-cfrg-ml-kem-security-considerations.md",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/7",
      "state": "MERGED",
      "author": "kmilner",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "This is a very quick description that I think might be worth fleshing out more, but I think it's worth mentioning. \r\n\r\nAssociate references: \r\n- https://www.iacr.org/archive/pkc2019/114420193/114420193.pdf is I believe the original proposal of the attack.\r\n- https://eprint.iacr.org/2022/952.pdf uses rowhammer to actually perform the attack in practice on frodokem, but it also applies to ML-KEM as discussed in appendix A.1\r\n\r\nI'm not sure this warrants adding a name to the author list but Scott said to do so--happy to contribute more explanation or other editing to the document.",
      "createdAt": "2024-10-07T22:02:57Z",
      "updatedAt": "2024-10-11T19:38:32Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "13994f9c42d2d64cfd4b21e8790cb9a08e63c02b",
      "headRepository": "kmilner/ml-kem-security-considerations",
      "headRefName": "patch-1",
      "headRefOid": "04d774b59a7125923bf73ce77457330ef58008d6",
      "closedAt": "2024-10-11T19:38:31Z",
      "mergedAt": "2024-10-11T19:38:31Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "12810127a3e20f2d378201641b1778623d88b262"
      },
      "comments": [
        {
          "author": "kmilner",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I think the advice would be to be protective about how your keys are generated in a way that may be unintuitive if you're used to traditional cryptosystems. Examples\r\n- An airgapped machine (or library) can generate 'valid' keypairs which allow an adversary to discover the private key later.\r\n- A user process on the machine can potentially interfere with key generation in such a way that the keys still work but are later breakable (the rowhammer paper above)\r\n- (assumption on my part, I don't know if there's literature on this) in an embedded environment power faults might be sufficient. \r\n\r\nYou could generally just mess with the entropy used in key generation to achieve a similar sort of 'booby-trapped' keys, though, so maybe it isn't worth calling out specifically. ",
          "createdAt": "2024-10-08T17:29:41Z",
          "updatedAt": "2024-10-08T17:29:41Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "The text you have is better; I would add two notes (and if you disagree with either of them, say so)\r\n- This is much less of a concern if you're using ML-KEM ephemerally (that is, using a public/private key pair only once)\r\n- If this is a concern, you should use an ML-KEM which has been hardened against such attacks.",
          "createdAt": "2024-10-09T21:04:19Z",
          "updatedAt": "2024-10-09T21:04:19Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "Thinking about it, I believe you have a good point.  I would propose this alternative text, which should more explicitly convey your concerns (and also when it is applicable, and also an actionable mitigation).  If you agree with this modified text, we can make that as your change (either you or I).  If you prefer your text, I'll go ahead and merge it.\r\n\r\nProposed alternative text:\r\n\r\nML-KEM has a potential weakness that did not apply to the classical DH or ECDH cryptosystems.  Lattice public keys are a lattice and a secret hidden by an error term. If the error term added public key generation stage is made larger due to a fault attack, then the success of decapsulation can reveal enough of the secret that successive queries determine the private key. That is, a public key can be 'poisoned' such that a future adversary can recover the private key even though it will appear correct in normal usage.  This applies only if an ML-KEM public key is used repeatedly.; it does not apply if ML-KEM is used ephemerally.  If that is the case, you may want to use an ML-KEM implementation that is hardened against such fault attacks.",
          "createdAt": "2024-10-10T16:27:03Z",
          "updatedAt": "2024-10-10T16:27:03Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86MUpDY",
          "commit": {
            "abbreviatedOid": "1cef240"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "COMMENTED",
          "body": "I\u2019m not sure it is worth mentioning.  \r\n\r\nThe goal of this draft is to give a security engineer who wants to use ML-KEM advice on how to use it safely.  Given this, what actionable advice could we give him?  ML-KEM is likely implemented by a crypto library - how can he ensure that the error vector is computed properly?  What steps could he take to mitigate this threat?\r\n",
          "createdAt": "2024-10-08T11:35:26Z",
          "updatedAt": "2024-10-08T11:35:26Z",
          "comments": []
        }
      ]
    },
    {
      "number": 8,
      "id": "PR_kwDOM54HI8596728",
      "title": "Update draft-sfluhrer-cfrg-ml-kem-security-considerations.md",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/8",
      "state": "MERGED",
      "author": "dklshiu",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "Added pieces on the importance of public key integrity, intermediate value deletion, checking for legitimate ciphertext generation. Also noted that DH is asynchronous and non-interactive whereas KEMs are not.",
      "createdAt": "2024-10-08T09:13:30Z",
      "updatedAt": "2024-10-10T16:40:52Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "e3a60b14813e22639f014005b2ea5b6aafe9eb7c",
      "headRepository": "dklshiu/ml-kem-security-considerations",
      "headRefName": "patch-1",
      "headRefOid": "8b22c7199eaf003067a72b695f835e96418a2dc8",
      "closedAt": "2024-10-10T16:40:52Z",
      "mergedAt": "2024-10-10T16:40:52Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "13994f9c42d2d64cfd4b21e8790cb9a08e63c02b"
      },
      "comments": [
        {
          "author": "dklshiu",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I'm trying to be as explicit as possible about the risks of public key modification in order to avoid future issues analagous to Curveball.  I've already had to try and warn people of the dangers of not explicitly protecting the decapsulator's copy of the public key https://crypto.stackexchange.com/questions/112925/why-is-the-public-key-included-in-the-private-key-in-kyber-kem/112927 and I fear that at some point in the future someone will ask if there's any issue with a \"compressed private key\" that omits the public key. In a similar vein, I worry that someone might notice that the re-encapsulation check never fails under ordinary circumstances and ask if there's an issue in skipping it. All this may be overcautious, but I've been burnt by people not fully understanding dangers in the past.",
          "createdAt": "2024-10-09T18:57:09Z",
          "updatedAt": "2024-10-09T18:57:09Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86MgKr6",
          "commit": {
            "abbreviatedOid": "880f995"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "CHANGES_REQUESTED",
          "body": "I'm not sure I agree with the part you added about making sure that Alice gets a correct copy of the public key.  As you note later on, the private key includes a copy of the private key, and so (as long as the private key is secure) Alice has a correct copy of the public key.\r\n\r\nShould this part of the change be included (I have no issue with the rest)?",
          "createdAt": "2024-10-09T13:54:59Z",
          "updatedAt": "2024-10-09T13:54:59Z",
          "comments": []
        },
        {
          "id": "PRR_kwDOM54HI86MuCqv",
          "commit": {
            "abbreviatedOid": "ecc43d7"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "You make good points.  I should remember the dangers of underestimating fools.",
          "createdAt": "2024-10-10T16:30:49Z",
          "updatedAt": "2024-10-10T16:30:49Z",
          "comments": []
        }
      ]
    },
    {
      "number": 9,
      "id": "PR_kwDOM54HI85_oi3V",
      "title": "Line wrap",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/9",
      "state": "MERGED",
      "author": "dconnolly",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "To 77 chars for better editability and alignment with final render",
      "createdAt": "2024-10-23T15:06:38Z",
      "updatedAt": "2024-10-23T18:13:42Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "7b4720c065d752fa501cc73bcf581d5f26d92797",
      "headRepository": "dconnolly/ml-kem-security-considerations",
      "headRefName": "wrap",
      "headRefOid": "a95457c47c2f47b26f56609c767fab60ecc848cb",
      "closedAt": "2024-10-23T17:57:56Z",
      "mergedAt": "2024-10-23T17:57:56Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "8c6cc706f78a98043e53acbb574a5715711123a9"
      },
      "comments": [
        {
          "author": "dconnolly",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Planning on it too!",
          "createdAt": "2024-10-23T17:33:01Z",
          "updatedAt": "2024-10-23T17:33:01Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86ObaAk",
          "commit": {
            "abbreviatedOid": "a95457c"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "Actually, I was hoping for more technical feedback, but I'll take reformatting as well.",
          "createdAt": "2024-10-23T17:31:46Z",
          "updatedAt": "2024-10-23T17:31:46Z",
          "comments": []
        }
      ]
    },
    {
      "number": 10,
      "id": "PR_kwDOM54HI85_qly1",
      "title": "Binding properties",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/10",
      "state": "CLOSED",
      "author": "dconnolly",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "Included an overview of binding properties for KEMs and for ML-KEM specifically.\r\n\r\n@bwesterb @sophieschmieg might have opinions to improve the text",
      "createdAt": "2024-10-23T18:52:16Z",
      "updatedAt": "2025-01-10T20:47:42Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "8c6cc706f78a98043e53acbb574a5715711123a9",
      "headRepository": "dconnolly/ml-kem-security-considerations",
      "headRefName": "binding",
      "headRefOid": "a43a576c14f13b278fab0fffe9e0ff3eb1290f57",
      "closedAt": "2024-11-15T14:46:20Z",
      "mergedAt": null,
      "mergedBy": null,
      "mergeCommit": null,
      "comments": [
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "I do not believe that ML-KEM suffers from reencapsulation attacks.  As such, I do not see the point in including an extended paragraph on them.  Remember, this is not about KEM's in general, but ML-KEM specifically. A more targeted paragraph (which mentions only those concerns specific to ML-KEM would be more reasonable.",
          "createdAt": "2024-10-23T19:10:08Z",
          "updatedAt": "2024-10-23T19:10:08Z"
        },
        {
          "author": "dconnolly",
          "authorAssociation": "CONTRIBUTOR",
          "body": "> I do not believe that ML-KEM suffers from reencapsulation attacks. As such, I do not see the point in including an extended paragraph on them. Remember, this is not about KEM's in general, but ML-KEM specifically. A more targeted paragraph (which mentions only those concerns specific to ML-KEM would be more reasonable.\r\n\r\nThe mention is a motivation for binding properties in general, and an earlier version of Signal PQXDH using a regular IND-CCA KEM was vulnerable to such an attack - they were saved by using an earlier version of Kyber, in part, but had to commit to more information in their AAD to mitigate it completely. They are relevant in how the recommended use of ML-KEM as now standardized in FIPS 203 is safe, but using another KEM in a similar way may not be (because IND-CCA is insufficient). We can pare it down though.",
          "createdAt": "2024-10-23T19:16:40Z",
          "updatedAt": "2024-10-23T19:16:40Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "The other issue is that this is mainly advice for protocol designers (and to a lesser extend, implementors).  If there is something they may need to be aware of (e.g. MAL-BIND-K-KT), we should explain what it is (in addition to pointing them to some academic paper they will have trouble understanding), when that threat is relevant, and how to mitigate that threat.",
          "createdAt": "2024-10-23T19:20:24Z",
          "updatedAt": "2024-10-23T19:20:24Z"
        },
        {
          "author": "dconnolly",
          "authorAssociation": "CONTRIBUTOR",
          "body": "> The other issue is that this is mainly advice for protocol designers (and to a lesser extend, implementors). If there is something they may need to be aware of (e.g. MAL-BIND-K-KT), we should explain what it is (in addition to pointing them to some academic paper they will have trouble understanding), when that threat is relevant, and how to mitigate that threat.\r\n\r\nYes, that is basically done in the ML-KEM-specific section at the end",
          "createdAt": "2024-10-23T19:40:29Z",
          "updatedAt": "2024-10-23T19:40:29Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "As written, I don't think its targeted towards the right audience; it should be towards protocol designers and protocol implementors. They don't care about learning about cryptography, they want explicit instructions about what they should do.  As such, we need to be much more explicit about exactly what these threats are, when they are relevant and how to mitigate them (and the advice 'use the 64 byte seed as the private' might not be doable, as the readers might not be able to control how their ML-KEM implementation functions - we should mention it, but realize that they might need an alternative).\r\n\r\nThinking it over, we might need to be more explicit about the various use cases for ML-KEM (I can think of four: key exchange/ephemeral, key exchange/static public key, public key encryption, and authentication) - whether the threats apply varies between the use cases.  [And, of course, if you can think of other use cases, please chime in].\r\n\r\nThis is a fairly large change; I'll go ahead and propose a rewrite - it'll take me a few days, though.  And, since we're in the IETF quiet period (no new submissions allowed until after Dublin), we have time...",
          "createdAt": "2024-10-24T13:19:42Z",
          "updatedAt": "2024-10-24T13:19:42Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "I've been going through it, and it's hard to come up with a plausible scenario where either MAL-BIND-K-CT nor MAL-BIND-K-PK is a threat (even in the case where ML-KEM is used for authentication). Both attack models assume that the adversary is either the private key holder, or can inject bogus private keying material).  However if they can pick the private key, well, they can already do pretty much what they want anyways (and so you don't have security in any case).\r\n\r\nIf we can't think of cases where these security properties might be needed, I don't know if they need to be mentioned.  Remember, this is not an academic paper - this tries to instruct protocol designers and implementors about things they need to keep in mind, and there's little point in having them worry about things that aren't actually a concern.\r\n\r\nAm I missing something?",
          "createdAt": "2024-10-25T21:46:03Z",
          "updatedAt": "2024-10-25T21:46:03Z"
        },
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "This text is still too targeted towards academics (it doesn't even define what MAL-BIND-K-CT or MAL-BIND-K-PT is, and instead refers to some paper which nonacademics will not understand), and doesn't talk about when some protocol designer would need to be concerned.  I did add a paragraph to the main text trying to describe the situation (in terms that a protocol designer would understand) - you might want to review that.\r\n\r\nAlso, I have to wonder - if MAL-BIND-* assumes that the attacker has control of the private key, why should we assume that there's any security properties at all?",
          "createdAt": "2024-11-15T14:49:52Z",
          "updatedAt": "2024-11-15T14:49:52Z"
        },
        {
          "author": "sophieschmieg",
          "authorAssociation": "NONE",
          "body": "No disagreement with you or the decision to close, just as additional context: I did have a scenario where an attacker controlled private key having or not having certain properties mattered, although it was not MAL-BIND-* in that case:\r\n\r\nThe scenario was that the protocol used a implicitly authenticated key exchange, i.e. both parties know a static public key of the other party. It computed the shared secret as KDF(ECDH(static_Alice, static_Bob) || ECDH(ephemeral_Alice, ephemeral_Bob)). This is a valid, two side authenticated, forward secret key exchange. Another team wanted to have a one side authenticated version of this protocol, and they did this by using a shared static key for Alice. This would technically be only a \"LEAK\" scenario in the terms of Cas' paper, but you could imagine that shared static key sitting on a writeable network share. The problem is that the handshake above has key compromise impersonation, so instead of degenerating into a one-side authenticated key exchange if one private key is compromised, it degenerates into an unauthenticated key exchange, since Eve can impersonate Bob to Alice and compute the shared secret using Alice's static private key and her ephemeral private key. A 3DH handshake KDF(ECDH(static_Alice, ephemeral_Bob) || ECDH(ephemeral_Alice, static_Bob) || ECDH(ephemeral_Alice, ephemeral_Bob)) degenerates as expected in this case.\r\n\r\nThe other, similar scenario where attacker controlled secret keys play a role is in the case of invisible salamanders. You can formulate those as various AEADs, AES-GCM most of all, not having LEAK-BIND-CT-PT, i.e. an attacker with knowledge of the key can craft a ciphertext that will decrypt to a different plaintext under a different key. That property also has caused real world vulnerabilities, but it doesn't apply to implicitly rejecting KEMs to begin with, as they never bind the ciphertext to the shared secret.\r\n\r\nSo in the end, while there are relevant examples of vulnerabilities that require the attacker to know the private key, none of the examples I am aware of, even in hypothetical protocols designed only to be vulnerable to misbinding attacks require KEMs binding against maliciously formed keys. In a document aimed at developers in particular, it would be hard to convey these nuances in a non-academic fashion, and the advice more or less becomes \"Have cryptographers look at your protocol, protocol design is hard and can introduce vulnerabilities even if secure primitives are used\". Even a generic \"Always hash in everything\" imho doesn't quite capture the problems here, since it already presumes a specific use case (and one where you probably should use TLS or HPKE), and in ML-KEM's case does not even apply, as it has stronger binding guarantees than e.g. X25519 or RSA.",
          "createdAt": "2025-01-10T20:47:41Z",
          "updatedAt": "2025-01-10T20:47:41Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86OesIp",
          "commit": {
            "abbreviatedOid": "865d73c"
          },
          "author": "danvangeest",
          "authorAssociation": "NONE",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2024-10-23T20:24:43Z",
          "updatedAt": "2024-10-23T20:24:43Z",
          "comments": [
            {
              "originalPosition": 235,
              "body": "```suggestion\r\nPer the analysis of the final {{FIPS203}} in Sophie Schmieg\u2019s [KEMMY24], a\r\n```",
              "createdAt": "2024-10-23T20:24:43Z",
              "updatedAt": "2024-10-23T20:24:43Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOM54HI86OevwC",
          "commit": {
            "abbreviatedOid": "865d73c"
          },
          "author": "dconnolly",
          "authorAssociation": "CONTRIBUTOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2024-10-23T20:26:25Z",
          "updatedAt": "2024-10-23T20:26:25Z",
          "comments": [
            {
              "originalPosition": 235,
              "body": "Ah thank you, whoops ",
              "createdAt": "2024-10-23T20:26:25Z",
              "updatedAt": "2024-10-23T20:26:25Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOM54HI86QDBya",
          "commit": {
            "abbreviatedOid": "9bdea6a"
          },
          "author": "dconnolly",
          "authorAssociation": "CONTRIBUTOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2024-11-05T21:17:23Z",
          "updatedAt": "2024-11-05T21:17:24Z",
          "comments": [
            {
              "originalPosition": 90,
              "body": "```suggestion\r\nThere are security properties beyond IND-CCA such as those studied in [CAS].\r\nThere are many variants. MAL-X is hardest to achieve, but failure to achieve\r\nit hasn't lead to practical attacks at present. LEAK-X is in the middle, and\r\nfailure to be LEAK-X has lead to reencapsulation attacks [PQXDH]. ML-KEM achieves\r\nLEAK-X, but not all MAL-X. The latter is discussed in the 'Security Properties' \r\nsection below.\r\n```",
              "createdAt": "2024-11-05T21:17:24Z",
              "updatedAt": "2024-11-05T21:17:24Z"
            }
          ]
        }
      ]
    },
    {
      "number": 12,
      "id": "PR_kwDOM54HI86CX9bC",
      "title": "Tweaks to get it compiling",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/12",
      "state": "MERGED",
      "author": "rgwilton",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2024-11-19T11:16:02Z",
      "updatedAt": "2024-11-19T12:59:19Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "cd2da26f3330b97f74b6b942dfc046ba57dcc78a",
      "headRepository": "rgwilton/ml-kem-security-considerations",
      "headRefName": "markdown_compile_fixes",
      "headRefOid": "82dd456e48521f0862872121e3a8752c2486719e",
      "closedAt": "2024-11-19T12:59:00Z",
      "mergedAt": "2024-11-19T12:59:00Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "1e15298e983afc133521ac0d75d4fbef7ddccf54"
      },
      "comments": [
        {
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "body": "Build fixes",
          "createdAt": "2024-11-19T12:59:18Z",
          "updatedAt": "2024-11-19T12:59:18Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86Rwdpe",
          "commit": {
            "abbreviatedOid": "82dd456"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "Many thanks.  I do have one question: what does the 'v: 3' field, and what is it supposed to signify?  The draft number?",
          "createdAt": "2024-11-19T12:58:06Z",
          "updatedAt": "2024-11-19T12:58:06Z",
          "comments": []
        }
      ]
    },
    {
      "number": 14,
      "id": "PR_kwDOM54HI86Cggwu",
      "title": "Acknowledgements",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/14",
      "state": "MERGED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2024-11-20T10:11:21Z",
      "updatedAt": "2024-11-21T20:18:52Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "1e15298e983afc133521ac0d75d4fbef7ddccf54",
      "headRepository": "emanjon/ml-kem-security-considerations",
      "headRefName": "patch-2",
      "headRefOid": "7a7d24b5870274a6ab2cb407065ed5ee36185723",
      "closedAt": "2024-11-21T20:18:51Z",
      "mergedAt": "2024-11-21T20:18:51Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "c27abe6369ff30072f9a0897685ebcf270bf86a2"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86SL2di",
          "commit": {
            "abbreviatedOid": "7a7d24b"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2024-11-21T20:18:37Z",
          "updatedAt": "2024-11-21T20:18:37Z",
          "comments": []
        }
      ]
    },
    {
      "number": 15,
      "id": "PR_kwDOM54HI86CghFI",
      "title": "venue:",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/15",
      "state": "MERGED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2024-11-20T10:12:00Z",
      "updatedAt": "2024-11-21T20:19:38Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "1e15298e983afc133521ac0d75d4fbef7ddccf54",
      "headRepository": "emanjon/ml-kem-security-considerations",
      "headRefName": "patch-3",
      "headRefOid": "b622ecb604a17b4ef533ef4158eaba61bd4f41ce",
      "closedAt": "2024-11-21T20:19:38Z",
      "mergedAt": "2024-11-21T20:19:38Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "d5a5c83f0fc1adc6eebd01cb4d346c88908c481d"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86SL2_t",
          "commit": {
            "abbreviatedOid": "b622ecb"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2024-11-21T20:19:30Z",
          "updatedAt": "2024-11-21T20:19:30Z",
          "comments": []
        }
      ]
    },
    {
      "number": 16,
      "id": "PR_kwDOM54HI86GNHw4",
      "title": "reference to draft-connolly-cfrg-hpke-mlkem",
      "url": "https://github.com/sfluhrer/ml-kem-security-considerations/pull/16",
      "state": "MERGED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "Closes #11",
      "createdAt": "2024-12-25T09:27:31Z",
      "updatedAt": "2025-01-30T02:07:05Z",
      "baseRepository": "sfluhrer/ml-kem-security-considerations",
      "baseRefName": "main",
      "baseRefOid": "d2af98f747ad06abf6f035d6d0a7a0807f079a28",
      "headRepository": "emanjon/ml-kem-security-considerations",
      "headRefName": "patch-4",
      "headRefOid": "2fb188de4f69b94303567c8484499cdcd8f87a4e",
      "closedAt": "2025-01-30T02:07:05Z",
      "mergedAt": "2025-01-30T02:07:05Z",
      "mergedBy": "sfluhrer",
      "mergeCommit": {
        "oid": "4f13a9f061923ea1d176017d9c8dfdbd429bc0b2"
      },
      "comments": [],
      "reviews": [
        {
          "id": "PRR_kwDOM54HI86Z8eln",
          "commit": {
            "abbreviatedOid": "2fb188d"
          },
          "author": "sfluhrer",
          "authorAssociation": "OWNER",
          "state": "APPROVED",
          "body": "",
          "createdAt": "2025-01-30T02:06:57Z",
          "updatedAt": "2025-01-30T02:06:57Z",
          "comments": []
        }
      ]
    }
  ]
}